{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/nicos/Dev/poc/poc-pwa/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport Dexie from 'dexie';\nexport var ISynchroRecordType;\n\n(function (ISynchroRecordType) {\n  ISynchroRecordType[\"ADD\"] = \"add\";\n  ISynchroRecordType[\"DELETE\"] = \"delete\";\n})(ISynchroRecordType || (ISynchroRecordType = {}));\n\nexport class AppDB extends Dexie {\n  constructor() {\n    super('PwaDb');\n    this.version(9).stores({\n      todoLists: '++id, recordType',\n      todoItems: '++id, todoListId, recordType'\n    }); // this.on('populate', () => this.populate());\n\n    this.on('populate', () => null);\n  }\n\n  populate() {\n    return _asyncToGenerator(function* () {\n      const todoListId = yield db.todoLists.add({\n        title: 'To Do Today'\n      });\n      yield db.todoItems.bulkAdd([{\n        todoListId,\n        title: 'Feed the birds'\n      }, {\n        todoListId,\n        title: 'Watch a movie'\n      }, {\n        todoListId,\n        title: 'Have some sleep'\n      }]);\n    })();\n  }\n\n  resetDatabase() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield db.transaction('rw', 'todoItems', 'todoLists', () => {\n        _this.todoItems.clear();\n\n        _this.todoLists.clear(); // this.populate();\n\n      });\n    })();\n  }\n\n}\nexport const db = new AppDB();","map":{"version":3,"mappings":";AAAA,OAAOA,KAAP,MAA6B,OAA7B;AAEA,WAAYC,kBAAZ;;AAAA,WAAYA,kBAAZ,EAA8B;EAC1BA;EACAA;AACH,CAHD,EAAYA,kBAAkB,KAAlBA,kBAAkB,MAA9B;;AAwBA,OAAM,MAAOC,KAAP,SAAqBF,KAArB,CAA0B;EAI5BG;IACI,MAAM,OAAN;IACA,KAAKC,OAAL,CAAa,CAAb,EAAgBC,MAAhB,CAAuB;MACnBC,SAAS,EAAE,kBADQ;MAEnBC,SAAS,EAAE;IAFQ,CAAvB,EAFJ,CAMI;;IACA,KAAKC,EAAL,CAAQ,UAAR,EAAoB,MAAM,IAA1B;EACH;;EAEKC,QAAQ;IAAA;MACV,MAAMC,UAAU,SAASC,EAAE,CAACL,SAAH,CAAaM,GAAb,CAAiB;QACtCC,KAAK,EAAE;MAD+B,CAAjB,CAAzB;MAGA,MAAMF,EAAE,CAACJ,SAAH,CAAaO,OAAb,CAAqB,CACvB;QACIJ,UADJ;QAEIG,KAAK,EAAE;MAFX,CADuB,EAKvB;QACIH,UADJ;QAEIG,KAAK,EAAE;MAFX,CALuB,EASvB;QACIH,UADJ;QAEIG,KAAK,EAAE;MAFX,CATuB,CAArB,CAAN;IAJU;EAkBb;;EAEKE,aAAa;IAAA;;IAAA;MACf,MAAMJ,EAAE,CAACK,WAAH,CAAe,IAAf,EAAqB,WAArB,EAAkC,WAAlC,EAA+C,MAAK;QACtD,KAAI,CAACT,SAAL,CAAeU,KAAf;;QACA,KAAI,CAACX,SAAL,CAAeW,KAAf,GAFsD,CAGtD;;MACH,CAJK,CAAN;IADe;EAMlB;;AAxC2B;AA2ChC,OAAO,MAAMN,EAAE,GAAG,IAAIT,KAAJ,EAAX","names":["Dexie","ISynchroRecordType","AppDB","constructor","version","stores","todoLists","todoItems","on","populate","todoListId","db","add","title","bulkAdd","resetDatabase","transaction","clear"],"sourceRoot":"","sources":["C:\\Users\\nicos\\Dev\\poc\\poc-pwa\\src\\services\\db.ts"],"sourcesContent":["import Dexie, { Table } from 'dexie';\r\n\r\nexport enum ISynchroRecordType {\r\n    ADD = 'add',\r\n    DELETE = 'delete',\r\n}\r\n\r\nexport interface Item {\r\n    id?: number;\r\n    name: string;\r\n}\r\n\r\nexport interface TodoList {\r\n    id?: number;\r\n    title: string;\r\n    todoItems?: TodoItem[];\r\n    recordType?: string;\r\n}\r\n\r\nexport interface TodoItem {\r\n    title: string;\r\n    id?: number;\r\n    todoListId?: any;\r\n    recordType?: string;\r\n}\r\n\r\nexport class AppDB extends Dexie {\r\n    todoItems!: Table<TodoItem, number>;\r\n    todoLists!: Table<TodoList, number>;\r\n\r\n    constructor() {\r\n        super('PwaDb');\r\n        this.version(9).stores({\r\n            todoLists: '++id, recordType',\r\n            todoItems: '++id, todoListId, recordType',\r\n        });\r\n        // this.on('populate', () => this.populate());\r\n        this.on('populate', () => null );\r\n    }\r\n\r\n    async populate() {\r\n        const todoListId = await db.todoLists.add({\r\n            title: 'To Do Today',\r\n        });\r\n        await db.todoItems.bulkAdd([\r\n            {\r\n                todoListId,\r\n                title: 'Feed the birds',\r\n            },\r\n            {\r\n                todoListId,\r\n                title: 'Watch a movie',\r\n            },\r\n            {\r\n                todoListId,\r\n                title: 'Have some sleep',\r\n            },\r\n        ]);\r\n    }\r\n\r\n    async resetDatabase() {\r\n        await db.transaction('rw', 'todoItems', 'todoLists', () => {\r\n            this.todoItems.clear();\r\n            this.todoLists.clear();\r\n            // this.populate();\r\n        });\r\n    }\r\n}\r\n\r\nexport const db = new AppDB();\r\n"]},"metadata":{},"sourceType":"module"}