{"ast":null,"code":"import { liveQuery } from 'dexie';\nimport { forkJoin, from, map, switchMap } from 'rxjs';\nimport { db } from 'src/services/db';\nimport * as i0 from \"@angular/core\";\nexport let CrudDbService = /*#__PURE__*/(() => {\n  class CrudDbService {\n    getRecords() {\n      let todoLists = [];\n      /** ancienne version */\n      // db.todoLists.toArray().then((datas: TodoList[]) => {\n      //     /** each list name */\n      //     datas.forEach((data: TodoList) => {\n      //         const listeName: string = data.title\n      //         db.todoItems.where({\n      //             todoListId: data.id,\n      //         }).toArray().then((todoItems: TodoItem[]) => {\n      //             todoLists.push({ id: data.id, title: listeName, todoItems: todoItems })\n      //         })\n      //     })\n      // })\n\n      /** nouvelle version */\n\n      from(liveQuery(() => db.todoLists.toArray())).pipe(map(lists => lists.map(list => {\n        const listeName = list.title;\n        from(liveQuery(() => db.todoItems.where({\n          todoListId: list.id\n        }).toArray())).pipe(map(todoItems => {\n          todoLists.push({\n            id: list.id,\n            title: listeName,\n            todoItems: todoItems\n          });\n        }));\n      })), switchMap(newListsObservables => forkJoin(newListsObservables))).subscribe(datas => {\n        console.log(\"ðŸ”¥ðŸ”¥ðŸ”¥\", datas);\n      });\n    }\n\n  }\n\n  CrudDbService.Éµfac = function CrudDbService_Factory(t) {\n    return new (t || CrudDbService)();\n  };\n\n  CrudDbService.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n    token: CrudDbService,\n    factory: CrudDbService.Éµfac,\n    providedIn: 'root'\n  });\n  return CrudDbService;\n})();","map":null,"metadata":{},"sourceType":"module"}