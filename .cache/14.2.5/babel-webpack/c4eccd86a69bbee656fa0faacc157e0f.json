{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/nicos/Dev/poc/poc-pwa/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { liveQuery } from 'dexie';\nimport { forkJoin, from, map, switchMap } from 'rxjs';\nimport { db, ISynchroRecordType } from 'src/services/db';\nimport * as i0 from \"@angular/core\";\nexport let CrudDbService = /*#__PURE__*/(() => {\n  class CrudDbService {\n    getRecords() {\n      return from(liveQuery(() => db.todoLists.toArray())).pipe(map(lists => lists.map(list => {\n        const listeName = list.title;\n        return db.todoItems.where({\n          todoListId: list.id\n        }).toArray().then(todoItems => {\n          return {\n            id: list.id,\n            title: listeName,\n            todoItems: todoItems\n          };\n        });\n      })), switchMap(newListsObservables => {\n        return forkJoin(newListsObservables);\n      }));\n    }\n\n    getItemsFromOneList(listId) {\n      return from(liveQuery(() => db.todoItems.where({\n        todoListId: listId\n      }).toArray()));\n    }\n\n    addList(listName) {\n      return from(db.todoLists.add({\n        title: listName,\n        recordType: ISynchroRecordType.ADD\n      }));\n    }\n\n    addListItem(listId, itemName) {\n      return from(db.todoItems.add({\n        title: itemName,\n        todoListId: listId,\n        recordType: ISynchroRecordType.ADD\n      }));\n    }\n\n    resetDatabase() {\n      return _asyncToGenerator(function* () {\n        return db.resetDatabase();\n      })();\n    }\n\n  }\n\n  CrudDbService.ɵfac = function CrudDbService_Factory(t) {\n    return new (t || CrudDbService)();\n  };\n\n  CrudDbService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CrudDbService,\n    factory: CrudDbService.ɵfac,\n    providedIn: 'root'\n  });\n  return CrudDbService;\n})();","map":null,"metadata":{},"sourceType":"module"}